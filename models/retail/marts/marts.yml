version: 2

exposures:
  - name: monthly_gross_revenue_dashboard
    label: "Revenue Dashboard! ðŸ“ˆ"
    description: Monthly revenue - simple extract of month with a simple sum of revenue.

    type: dashboard 
    url: http://localhost:13393/dashboard/1-revenue
    
    owner:
      name: Randy Pitcher âš¡
      email: randy@work.com

    depends_on:
      - ref('monthly_gross_revenue')


models:
  - name: monthly_gross_revenue
    columns:
      - name: ORDER_MONTH
        tests:
          - unique
          - not_null
      - name: GROSS_REVENUE
        tests:
          - not_null
          - greater_than

metrics:
  - name:  num_customers
    label: Number of Customers
    tags: 
      - retail
    model: ref('fct_order_items')
    description: "The number of customers"

    calculation_method: count_distinct
    expression: customer_key

    timestamp: order_date
    time_grains: [day, week, month, quarter, year]

    dimensions:
      - market_segment
      - nation
      - region
    
    filters:
      - field: account_balance
        operator: '>'
        value: '0'
      - field: name
        operator: '!='
        value: ''